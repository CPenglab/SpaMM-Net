# SpaMM-Net
SpaMM-Net: spatially multimodal and multiscale network for representation learning from spatial multi-omics
## Installation
1. Clone this repo.
2. Copy "SpaMM-Net" folder in your project.

## Example
### Quick Start
#### 1. data loading
You can load your .h5ad files with scanpy. then process the objects with the preprocessing and adata_const functions provided by the 'spamm'.
```
import scanpy as sc
import spamm as spm
# load data
om1_adata = sc.read_h5ad('/path/to/om1.h5ad')
om2_adata = sc.read_h5ad('/path/to/om2.h5ad')

# data preprocessing(Optional)
# This step performs PCA to generate the "X_pca" matrix in om1_adata.obsm and om2_adata.obsm.
spm.preprocessing(
    om1_adata, om2_adata,
    n_comps = 50, random_state = 2025
)

# generate the input adata of SpaMM
adata = spm.adata_const(
    om1_adata, om2_adata,
    spatial_net_k = 8,
    om_net_k = [8, 15]
)
```
Here, we provide three AnnData objects generated by spm.adata_const(), which can be loaded for testing.
```
adata = spm.load_test_data(idx = 0)
```
#### 2. data training
```
output, model = spm.run_spamm(
    adata, scale = 3, epochs = 600, lr = 0.001, lr_step = [100, 200], gamma = 0.1,
    rtn_model = True
)
```
The 'output' is a dictionary with:
- 'feat' as a fixed key
- Dynamic keys 'scale1', 'scale2', ..., up to the number you specified in the 'scale' parameter.

#### 3. visualization
```
import seaborn as sns

```
